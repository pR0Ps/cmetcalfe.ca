<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Carey Metcalfe">
  <meta name="description" content="Posts tagged with 'website' on this site">

  <link rel="stylesheet" type="text/css" href="../../theme/css/styles.ec0bdb0f.min.css">

  <script src="../../theme/js/scripts.7db5858b.min.js" type="text/javascript"></script>

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">

  <link href="https://cmetcalfe.ca/feeds/all.rss" type="application/rss+xml" rel="alternate" title="Carey Metcalfe Full RSS Feed" />


  <title>Tag: website | Carey Metcalfe</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28306875-1', 'cmetcalfe.ca');
  ga('send', 'pageview');
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="../..">
        <img src="/images/avatar.jpg" id="logo">
      </a>
      <h2><a href="../.." class="nohover">Carey Metcalfe</a></h2>
      <p>Software Developer</p>
      <div class="social">
          <a data-email="ac.eflactemc@yerac:otliam" data-title="Email" title="You need javascript enabled to view this email" class="email" target="_blank" rel="noopener noreferrer"><i class="fa fa-envelope fa-lg"></i></a>
          <a href="https://github.com/pR0Ps" title="GitHub" target="_blank" rel="noopener noreferrer"><i class="fa fa-github fa-lg"></i></a>
          <a href="https://twitter.com/CareyMetcalfe" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter fa-lg"></i></a>
      </div>
      <ul>
      </ul>
    </div>
  </aside>

  <main id="main">
    <header>
      <p id="header">
      <a href="../..">Home</a>

      &#124; <a href="../../blog/index.html">Blog</a>
      &#124; <a href="https://cmetcalfe.ca/feeds/all.rss">RSS Feed</a>
      </p>
<p>Tag: website
</p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="../../blog/proxied-access-to-namecheap-dns.html">Proxied access to the Namecheap DNS API</a></h1>
  </div>
  <div class="article_text">
    <h2>Background</h2>
<p>Both this site and my home server use HTTPS certificates provided by <a href="https://letsencrypt.org">Let's Encrypt</a>.
<a href="../../blog/adding-https-support.html">Previously</a> I was using the <code>http-01</code> challenge method, but once <a href="https://community.letsencrypt.org/t/acme-v2-and-wildcard-certificate-support-is-live/55579">wildcard
certificates became available</a>, I decided to switch to the <code>dns-01</code> method for simplicity.</p>
<p>My domains are currently registered through <a href="https://www.namecheap.com/">Namecheap</a> which provides an API for modifying DNS
records. The only catch is that it can only be accessed via manually-whitelisted IP addresses.
Because the server I'm trying to access the API from is assigned a dynamic IP, this restriction was
a bit of an issue.</p>
<p>Back in November when I initially made the switch to the DNS-based challenge, I set it up the easy
way: I manually added my current IP to the whitelist, added a TODO entry to fix it somehow, and set
a reminder scheduled for the week before the cert would expire telling me to update the IP
whitelist. Fast-forward to today when I was reminded to update my IP whitelist. Instead of
continuing to kick the can down the road, I decided to actually fix the issue.</p>
<h2>Setting up a temporary proxy</h2>
<p>My home server is connected to the internet though a normal residential connection which is assigned
a dynamic IP address. However, the server that I run this website on is configured with a static IP
since it's a hosted <a href="https://en.wikipedia.org/wiki/Virtual_private_server">VPS</a>. By proxying all traffic to the Namecheap API through my VPS, I could
add my VPS's static IP to the whitelist and not have to worry about my home IP changing all the
time.</p>
<p>SSH is perfect tool for this. The <a href="https://www.openssh.com/">OpenSSH client</a> supports port forwarding using the <code>-D</code> flag.
By then setting the <code>HTTP[S]_PROXY</code> environment variables to point to the forwarded port, programs
that support those environment variables will transparently forward all their requests through the
proxy.</p>
<p>After a bunch of research and testing, I came up with the following script to easily set up the
temporary proxy:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># Source this file to automatically setup and teardown an HTTP* proxy through cmetcalfe.ca</span>
<span class="c1"># Use the PROXY_PORT and PROXY_DEST environment variables to customize the proxy</span>

<span class="nv">PROXY_PORT</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROXY_PORT</span><span class="k">:-</span><span class="nv">11111</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">PROXY_DEST</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PROXY_DEST</span><span class="k">:-</span><span class="p">&lt;username&gt;@cmetcalfe.ca</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">PID</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$$</span><span class="s2">&quot;</span>

<span class="c1"># Teardown the SSH connection when the script exits</span>
<span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;ssh -q -S &quot;.ctrl-socket-$PID&quot; -O exit &quot;$PROXY_DEST&quot;&#39;</span><span class="w"> </span>EXIT

<span class="c1"># Set up an SSH tunnel and wait for the port to be forwarded before continuing</span>
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span>ssh<span class="w"> </span>-o<span class="w"> </span><span class="nv">ExitOnForwardFailure</span><span class="o">=</span>yes<span class="w"> </span>-M<span class="w"> </span>-S<span class="w"> </span><span class="s2">&quot;.ctrl-socket-</span><span class="nv">$PID</span><span class="s2">&quot;</span><span class="w"> </span>-f<span class="w"> </span>-N<span class="w"> </span>-D<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROXY_PORT</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROXY_DEST</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed to open SSH tunnel, exiting&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>

<span class="c1"># Set environment variables to redirect HTTP* traffic through the proxy</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">HTTP_PROXY</span><span class="o">=</span><span class="s2">&quot;socks5://127.0.0.1:</span><span class="nv">$PROXY_PORT</span><span class="s2">&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">HTTPS_PROXY</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HTTP_PROXY</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>

<p>This script is saved as <code>~/.config/tempproxy.rc</code> and can be sourced to automatically set up a proxy
session and have it be torn down when the script exits.</p>
<p>You'll want to use key-based authentication with an unencrypted private key so that you don't need
to type anything to initiate the SSH session. For this reason you'll probably want to create a
limited user on the target system that can only really do port forwarding. There's a good post on
this <a href="https://askubuntu.com/questions/48129/how-to-create-a-restricted-ssh-user-for-port-forwarding/50000#50000">here</a>.</p>
<h2>Talking to the API through the proxy</h2>
<p>To allow programs that use the <code>tempproxy.rc</code> script to talk to the Namecheap API, the IP address of
the VPS was added to the whitelist. Now that the proxying issue was taken care of, I just needed
to wire up the actual certificate renewal process to use it.</p>
<p>The tool I'm using to talk to the Namecheap DNS API is <a href="https://github.com/AnalogJ/lexicon">lexicon</a>. It can handle manipulating the
DNS records of a ton of providers and integrates really nicely with my <a href="https://en.wikipedia.org/wiki/Automated_Certificate_Management_Environment">ACME</a> client of choice,
<a href="https://github.com/lukas2511/dehydrated">dehydrated</a>. Also, because it's using the <a href="https://github.com/Bemmu/PyNamecheap">PyNamecheap</a> Python library, which in turn uses
<a href="http://python-requests.org">requests</a> under the hood, it will <a href="http://docs.python-requests.org/en/master/user/advanced/#proxies">automatically use the <code>HTTP*_PROXY</code> environment
variables</a> when making requests.</p>
<p>The only tricky bit is that the base install of <code>lexicon</code> won't automatically pull in the packages
required for accessing the Namecheap API. Likewise, <code>requests</code> won't install packages to support
SOCKS proxies. To install all the required packages you'll need to run a command like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span><span class="s1">&#39;requests[socks]&#39;</span><span class="w"> </span><span class="s1">&#39;dns-lexicon[namecheap]&#39;</span>
</code></pre></div></td></tr></table></div>

<p>Since lexicon can use environment variables as configuration, I created another small source-able
file at <code>~/.config/lexicon.rc</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># Sets environment variables for accessing the Namecheap API</span>

<span class="c1"># Turn on API access and get an API token here:</span>
<span class="c1"># https://ap.www.namecheap.com/settings/tools/apiaccess/</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PROVIDER</span><span class="o">=</span>namecheap
<span class="nb">export</span><span class="w"> </span><span class="nv">LEXICON_NAMECHEAP_USERNAME</span><span class="o">=</span>&lt;username&gt;
<span class="nb">export</span><span class="w"> </span><span class="nv">LEXICON_NAMECHEAP_TOKEN</span><span class="o">=</span>&lt;api<span class="w"> </span>token&gt;
</code></pre></div></td></tr></table></div>

<p>With that in place, the existing automation script that I had previously set up when I switched to
using the <code>dns-01</code> challenge just needed some minor tweaks to source the two new files. I've
provided the script below, along with some other useful ones that use the DNS API.</p>
<h2>Scripts</h2>
<h3><code>do-letsencrypt.sh</code></h3>
<p>This is the main script that handles all the domain renewals. It's called via <code>cron</code> on the first
of every month.</p>
<p>Fun fact: The previous <code>http-01</code> version of this script was a mess - it involved juggling <code>nginx</code>
configurations with symlinks, manually opening up the <code>.well-known/acme-challenge</code> endpoint, and
some other terrible hacks. This version is <em>much</em> nicer.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># Generate/renew Let&#39;s Encrypt certificates using dehydrated and lexicon</span>

<span class="nb">set</span><span class="w"> </span>-e

<span class="c1"># Set configuration variables and setup the proxy</span>
<span class="nb">source</span><span class="w"> </span>~/.config/lexicon.rc
<span class="nb">source</span><span class="w"> </span>~/.config/tempproxy.rc

<span class="nb">cd</span><span class="w"> </span>/etc/nginx/ssl

<span class="c1"># Update the certs.</span>
<span class="c1"># Hook script copied verbatim from</span>
<span class="c1"># https://github.com/AnalogJ/lexicon/blob/master/examples/dehydrated.default.sh</span>
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span>dehydrated<span class="w"> </span>--accept-terms<span class="w"> </span>--cron<span class="w"> </span>--challenge<span class="w"> </span>dns-01<span class="w"> </span>--hook<span class="w"> </span>dehydrated.default.sh<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed to renew certificates&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>

<span class="c1"># Reload the nginx config if it&#39;s currently running</span>
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span>systemctl<span class="w"> </span>is-active<span class="w"> </span>nginx.service<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;nginx isn&#39;t running, not reloading it&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span>!<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>nginx.service<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>systemctl<span class="w"> </span>status<span class="w"> </span>nginx.service
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed to reload nginx config, check the error log&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>
</code></pre></div></td></tr></table></div>

<h3><code>dns.sh</code></h3>
<p>This one is really simple - it just augments the normal lexicon CLI interface with the proxy and
configuration variables.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># A simple wrapper around lexicon.</span>
<span class="c1"># Sets up the proxy and configuration, then passes all the arguments to the configured provider</span>

<span class="nb">source</span><span class="w"> </span>~/.config/lexicon.rc
<span class="nb">source</span><span class="w"> </span>~/.config/tempproxy.rc
lexicon<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROVIDER</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>$<span class="w"> </span>./dns.sh<span class="w"> </span>list<span class="w"> </span>cmetcalfe.ca<span class="w"> </span>A
ID<span class="w">       </span>TYPE<span class="w"> </span>NAME<span class="w">             </span>CONTENT<span class="w">         </span>TTL
--------<span class="w"> </span>----<span class="w"> </span>----------------<span class="w"> </span>---------------<span class="w"> </span>----
xxxxxxxx<span class="w"> </span>A<span class="w">    </span>@.cmetcalfe.ca<span class="w">   </span>xxx.xxx.xxx.xxx<span class="w"> </span><span class="m">1800</span>
xxxxxxxx<span class="w"> </span>A<span class="w">    </span>www.cmetcalfe.ca<span class="w"> </span>xxx.xxx.xxx.xxx<span class="w"> </span><span class="m">1800</span>
</code></pre></div></td></tr></table></div>

<h3><code>dns-update.sh</code></h3>
<p>An updated version of my <a href="../../blog/dynamic-dns-client-for-namecheap.html">previous script</a> that uses the API instead of the
<a href="https://www.namecheap.com/support/knowledgebase/article.aspx/29/11/how-do-i-use-a-browser-to-dynamically-update-the-hosts-ip">DynamicDNS service Namecheap provides</a>. Called via <code>cron</code> every 30 minutes.</p>
<div class="admonition update">
<p class="admonition-title">Update</p>
<p>A previous version of this script didn't try to delete the DNS entry before setting the new one,
resulting in multiple IPs being set as the same <code>A</code> record.</p>
<p>This is because the <a href="https://github.com/AnalogJ/lexicon/blob/1feca5ead36cbf85ad92676dc853045e2c646097/lexicon/providers/namecheap.py#L233">update function of the Namecheap plugin for lexicon</a> is implemented as a
2-step delete and add. When it tries to delete the old record, it looks for one with the same
content as the old one. This means that if you update a record with a new IP, it doesn't find
the old record to delete first, leaving you with all of your old IPs set as individual A
records.</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="c1"># Check the server&#39;s current IP against the IP listed in its DNS entry.</span>
<span class="c1"># Set the current IP if they differ.</span>

<span class="nb">set</span><span class="w"> </span>-e

resolve<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">line</span><span class="o">=</span><span class="k">$(</span>drill<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>@resolver1.opendns.com<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;/;;.*$/d;/^\s*$/d&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$line</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-1<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f5
<span class="o">}</span>

<span class="nv">dns</span><span class="o">=</span><span class="k">$(</span>resolve<span class="w"> </span>&lt;subdomain&gt;.cmetcalfe.ca<span class="k">)</span>
<span class="nv">curr</span><span class="o">=</span><span class="k">$(</span>resolve<span class="w"> </span>myip.opendns.com<span class="k">)</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dns</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$curr</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">source</span><span class="w"> </span>~/.config/lexicon.rc
<span class="w">    </span><span class="nb">source</span><span class="w"> </span>~/.config/tempproxy.rc
<span class="w">    </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>lexicon<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROVIDER</span><span class="s2">&quot;</span><span class="w"> </span>delete<span class="w"> </span>cmetcalfe.ca<span class="w"> </span>A<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;&lt;subdomain&gt;.cmetcalfe.ca&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed to delete old DNS record, not setting the new one.&quot;</span>
<span class="w">        </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>lexicon<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROVIDER</span><span class="s2">&quot;</span><span class="w"> </span>update<span class="w"> </span>cmetcalfe.ca<span class="w"> </span>A<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;&lt;subdomain&gt;.cmetcalfe.ca&quot;</span><span class="w"> </span>--content<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$curr</span><span class="s2">&quot;</span><span class="w"> </span>--ttl<span class="o">=</span><span class="m">900</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Server DNS record updated (</span><span class="nv">$dns</span><span class="s2"> -&gt; </span><span class="nv">$curr</span><span class="s2">)&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Server DNS record update FAILED (tried </span><span class="nv">$dns</span><span class="s2"> -&gt; </span><span class="nv">$curr</span><span class="s2">)&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="k">fi</span>
</code></pre></div></td></tr></table></div>
  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="../../blog/bank-of-canada-conversion-rates-terminal.html">Bank of Canada currency conversion rates in the terminal</a></h1>
  </div>
  <div class="article_text">
    <h1>Preface</h1>
<p>In this entry I'll use two command line tools (<a href="https://curl.haxx.se/"><code>curl</code></a> and <a href="https://stedolan.github.io/jq/"><code>jq</code></a>) to request currency
conversion rates from the <a href="https://www.bankofcanada.ca">Bank of Canada</a>. Now obviously getting the same data through the <a href="https://www.bankofcanada.ca/rates/exchange/daily-exchange-rates-lookup/">normal
web interface</a> is possible as well. However, doing it this way returns the data in a
machine-readable form, allowing it to be customized or used as input into other programs.</p>
<p>The basic flow will be request the data using <code>curl</code>, then pipe it to <code>jq</code> for processing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This article will request the USD/CAD exchange rate from 2017-01-01 to 2017-01-10. It should be
fairly obvious how to switch this for any other currencies or date ranges. See the
<a href="#appendix">Appendix</a> for more information and caveats with the dates and the conversion codes.</p>
</div>
<p>We'll go from seeing the raw data the server returns to something that we can more easily use. <strong>To
skip to the final result, click <a href="#tldr">here</a></strong>.</p>
<div class="admonition update">
<p class="admonition-title">Update</p>
<p>The URLs for the data were originally reverse-engineered from the website. They have since been
turned into a supported API. See <a href="https://www.bankofcanada.ca/valet/docs">the API documentation</a> for more details.</p>
</div>
<h1>Lets go!</h1>
<p>Hitting the server without any processing will give the following result:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://www.bankofcanada.ca/valet/observations/FXUSDCAD/json?start_date=2017-01-01&amp;end_date=2017-01-10&quot;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;terms&quot;</span><span class="p">:{</span>
<span class="w">    </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://www.bankofcanada.ca/terms/&quot;</span>
<span class="p">},</span>
<span class="nt">&quot;seriesDetail&quot;</span><span class="p">:{</span>
<span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="s2">&quot;USD/CAD&quot;</span><span class="p">,</span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;US dollar to Canadian dollar daily exchange rate&quot;</span><span class="p">}</span>
<span class="p">},</span>
<span class="nt">&quot;observations&quot;</span><span class="p">:[</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-02&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;e&quot;</span><span class="p">:</span><span class="mi">-64</span><span class="p">}},</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-03&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;v&quot;</span><span class="p">:</span><span class="mf">1.3435</span><span class="p">}},</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-04&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;v&quot;</span><span class="p">:</span><span class="mf">1.3315</span><span class="p">}},</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-05&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;v&quot;</span><span class="p">:</span><span class="mf">1.3244</span><span class="p">}},</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-06&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;v&quot;</span><span class="p">:</span><span class="mf">1.3214</span><span class="p">}},</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-09&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;v&quot;</span><span class="p">:</span><span class="mf">1.3240</span><span class="p">}},</span>
<span class="p">{</span><span class="nt">&quot;d&quot;</span><span class="p">:</span><span class="s2">&quot;2017-01-10&quot;</span><span class="p">,</span><span class="nt">&quot;FXUSDCAD&quot;</span><span class="p">:{</span><span class="nt">&quot;v&quot;</span><span class="p">:</span><span class="mf">1.3213</span><span class="p">}}</span>
<span class="p">]</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>

<p>To get the information we want, we need to iterate over the elements in the <code>observations</code> list and
map the date (<code>d</code>) to the conversion rate (<code>FXUSDCAD.v</code>). Since this will create a list of
single-element dictionaries, we'll also need to "add" (merge) them together.</p>
<p>To do this with <code>jq</code>, it looks like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://www.bankofcanada.ca/valet/observations/FXUSDCAD/json?start_date=2017-01-01&amp;end_date=2017-01-10&quot;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">    [.observations[] | {(.d) : .FXUSDCAD.v}] | add</span>
<span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;2017-01-02&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-03&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3435</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-04&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3315</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-05&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3244</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-06&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3214</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-09&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.324</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-10&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3213</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>

<p>That first <code>null</code> entry where there was no data is going to cause problems later, so let's just
delete it using the <code>del</code> function:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://www.bankofcanada.ca/valet/observations/FXUSDCAD/json?start_date=2017-01-01&amp;end_date=2017-01-10&quot;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">    [.observations[] | {(.d) : .FXUSDCAD.v}] | add | del(.[] | nulls)</span>
<span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;2017-01-03&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3435</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-04&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3315</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-05&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3244</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-06&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3214</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-09&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.324</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;2017-01-10&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3213</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>

<p>Now this may be good enough for most purposes, but it would be useful to compute some other
statistics from this data. For example, we want to know the average exchange rate for the date
range. Now that we have the data in an easy to use format, computing an average with <code>jq</code> is just a
matter of passing the values to an <code>add / length</code> filter. For example:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://www.bankofcanada.ca/valet/observations/FXUSDCAD/json?start_date=2017-01-01&amp;end_date=2017-01-10&quot;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">    [.observations[] | {(.d) : .FXUSDCAD.v}] | add | del(.[] | nulls) | add / length</span>
<span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">1.327683333333333</span>
</code></pre></div></td></tr></table></div>

<p><a name="tldr"></a>We can now construct an object that has both the average, as well as all the
data. Putting it all together we get:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://www.bankofcanada.ca/valet/observations/FXUSDCAD/json?start_date=2017-01-01&amp;end_date=2017-01-10&quot;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">    [.observations[] | {(.d) : .FXUSDCAD.v}] | add | del(.[] | nulls) |</span>
<span class="s1">    {</span>
<span class="s1">        &quot;average&quot;: (add / length),</span>
<span class="s1">        &quot;values&quot;: .</span>
<span class="s1">    }</span>
<span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;average&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.327683333333333</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;2017-01-03&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3435</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;2017-01-04&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3315</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;2017-01-05&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3244</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;2017-01-06&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3214</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;2017-01-09&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.324</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;2017-01-10&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.3213</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>

<p>And that's it! Hopefully you found this useful, if not for it's stated purpose of retrieving
exchange rates, then at least for getting more familiar with <code>jq</code>. It's pretty much the best tool
out there when it comes to manipulating JSON on the command line.</p>
<h1>Appendix<a name="appendix"></a></h1>
<h3>Date ranges</h3>
<ul>
<li>The server will only ever return data from <code>2017-01-03</code> and onwards. If the start range is before
  that, it doesn't return an error, it just doesn't return any data for those dates.</li>
<li>If the end date isn't specified, the server assumes the current date.</li>
<li>There doesn't seem to be any limit on the amount of data retrieved</li>
</ul>
<h3>Currency codes</h3>
<p>A list of codes can be easily scraped from the lookup page. The command and its result are below for
reference.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;https://www.bankofcanada.ca/rates/exchange/daily-exchange-rates-lookup/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-Eo<span class="w"> </span><span class="s1">&#39;&quot;FX......&quot;.*&lt;&#39;</span>
</code></pre></div></td></tr></table></div>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code>&quot;FXAUDCAD&quot;&gt;Australian dollar&lt;
&quot;FXBRLCAD&quot;&gt;Brazilian real&lt;
&quot;FXCNYCAD&quot;&gt;Chinese renminbi&lt;
&quot;FXEURCAD&quot;&gt;European euro&lt;
&quot;FXHKDCAD&quot;&gt;Hong Kong dollar&lt;
&quot;FXINRCAD&quot;&gt;Indian rupee&lt;
&quot;FXIDRCAD&quot;&gt;Indonesian rupiah&lt;
&quot;FXJPYCAD&quot;&gt;Japanese yen&lt;
&quot;FXMYRCAD&quot;&gt;Malaysian ringgit&lt;
&quot;FXMXNCAD&quot;&gt;Mexican peso&lt;
&quot;FXNZDCAD&quot;&gt;New Zealand dollar&lt;
&quot;FXNOKCAD&quot;&gt;Norwegian krone&lt;
&quot;FXPENCAD&quot;&gt;Peruvian new sol&lt;
&quot;FXRUBCAD&quot;&gt;Russian ruble&lt;
&quot;FXSARCAD&quot;&gt;Saudi riyal&lt;
&quot;FXSGDCAD&quot;&gt;Singapore dollar&lt;
&quot;FXZARCAD&quot;&gt;South African rand&lt;
&quot;FXKRWCAD&quot;&gt;South Korean won&lt;
&quot;FXSEKCAD&quot;&gt;Swedish krona&lt;
&quot;FXCHFCAD&quot;&gt;Swiss franc&lt;
&quot;FXTWDCAD&quot;&gt;Taiwanese dollar&lt;
&quot;FXTHBCAD&quot;&gt;Thai baht&lt;
&quot;FXTRYCAD&quot;&gt;Turkish lira&lt;
&quot;FXGBPCAD&quot;&gt;UK pound sterling&lt;
&quot;FXUSDCAD&quot;&gt;US dollar&lt;
&quot;FXVNDCAD&quot;&gt;Vietnamese dong&lt;
</code></pre></div></td></tr></table></div>
  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="../../blog/adding-https-support.html">Adding HTTPS support to this site</a></h1>
  </div>
  <div class="article_text">
    <p>Yesterday I finally ticked something off my todo list that'd been on there for a while - I added
proper HTTPS support to this site, powered by <a href="https://letsencrypt.org/">Let's Encrypt</a>.</p>
<p>The Qualys SSL Labs <a href="https://www.ssllabs.com/ssltest/index.html">SSL Server Test</a> now gives this site <a href="https://www.ssllabs.com/ssltest/analyze.html?d=cmetcalfe.ca">an A+ rating</a>. You can see all the
certs (past and present) for it on <a href="https://crt.sh/?q=cmetcalfe.ca">crt.sh</a>, an online certificate search tool.</p>
<h3>For those interested in how things work:</h3>
<p><a href="https://letsencrypt.org/">Let's Encrypt</a> is a "free, automated, and open" certificate authority. They provide certificates
via an <a href="https://letsencrypt.org/howitworks/technology/">automatable process</a> that are valid for <a href="https://letsencrypt.org/2015/11/09/why-90-days.html">90 days</a>.</p>
<p>Exactly how I got it all working can be seen in my <a href="https://github.com/pR0Ps/website">website repo</a>, where this entire site and it's
deployment scripts are kept, but here's the gist of it:</p>
<p>I decided to use <a href="https://github.com/lukas2511/dehydrated"><code>dehydrated</code></a> instead of the <a href="https://github.com/letsencrypt/letsencrypt">official Let's Encrypt client</a> to
generate the certificates. <code>dehydrated</code> is ~1000 lines of <code>bash</code> and only requires things like
<code>openssl</code>, <code>curl</code>, and a few other programs that any UNIX system should already have. It takes a
config file and a list of domains. Once those are in place running it from <code>cron</code> is easy.</p>
<p>The <a href="https://github.com/letsencrypt/acme-spec">ACME protocol</a> that Let's Encrypt uses to verify domain ownership requires the web server to
respond to certain requests. This check makes sure that only someone with control over the domain
can generate a cert for it. To allow those requests to return the files generated by <code>dehydrated</code>,
a <a href="https://github.com/pR0Ps/website/blob/8b3f9509e5f97522ac01789ca562409a7475cc60/web_config/https/letsencrypt.conf">location rule in the Nginx config</a> was added.</p>
<p>Initially there were problems with the first time generating certs. Since the certs didn't exist
yet, Nginx was failing to start (and therefore causing the domain validation to fail). The solution
was to make two sets of configs. An HTTP set, and an HTTPS set. During the renewal process, the HTTPS
configs are tried, and if running Nginx fails, it falls back to the HTTP set. Switching between HTTP
and HTTPS configs is done by modifying a symlink.</p>
<p>When all set up, this makes both generating a cert for the first time and renewing a cert as easy as
deploying the site. For continual, automated renewals, a monthly <code>cron</code> job was added. With the
expiry of certs being 90 days, this should be frequent enough that the certs should never expire.</p>
  </div>
</article>

<footer>
<div id="paginator">
  <span id="left">
  </span>
  <span id="right">
      <a href="../../blog/tags/website2.html">Next <i class="fa fa-arrow-circle-right"></i></a>
  </span>
  <div>
      <a href="../../blog/tags/website.html">[1]</a>
      <a href="../../blog/tags/website2.html"> 2 </a>
      <a href="../../blog/tags/website3.html"> 3 </a>
  </div>
</div>
</footer>

    <div id="ending_message">
        <p>&copy; Carey Metcalfe. Built using <a href="http://getpelican.com">Pelican</a>. Theme is <a href="https://github.com/pR0Ps/pelican-subtle">subtle</a> by <a href="http://cmetcalfe.ca">Carey Metcalfe</a>. Based on <a href="https://github.com/giulivo/pelican-svbhack">svbhack</a> by Giulio Fidente.</p>
    </div>
  </main>

  <script type="text/javascript">
    window.addEventListener('load', skipHeader)
  </script>

  <script type="text/javascript">
  window.addEventListener('load', unmangleEmail)
  </script>
</body>
</html>