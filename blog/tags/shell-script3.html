<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Carey Metcalfe">
  <meta name="description" content="Posts tagged with 'shell script' on this site">

  <link rel="stylesheet" type="text/css" href="../../theme/css/styles.518a5e28.min.css">

  <script src="../../theme/js/scripts.ab06d70e.min.js" type="text/javascript"></script>

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">

  <link href="https://cmetcalfe.ca/feeds/all.rss" type="application/rss+xml" rel="alternate" title="Carey Metcalfe Full RSS Feed" />


  <title>Tag: shell script | Carey Metcalfe</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28306875-1', 'cmetcalfe.ca');
  ga('send', 'pageview');
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="../..">
        <img src="/images/avatar.jpg" id="logo">
      </a>
      <h2><a href="../.." class="nohover">Carey Metcalfe</a></h2>
      <p>Software Developer</p>
      <div class="social">
          <a data-email="ac.eflactemc@yerac:otliam" data-title="Email" title="You need javascript enabled to view this email" class="email" target="_blank" rel="noopener noreferrer"><i class="fa fa-envelope fa-lg"></i></a>
          <a href="https://github.com/pR0Ps" title="GitHub" target="_blank" rel="noopener noreferrer"><i class="fa fa-github fa-lg"></i></a>
          <a href="https://twitter.com/CareyMetcalfe" title="Twitter" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter fa-lg"></i></a>
      </div>
      <ul>
      </ul>
    </div>
  </aside>

  <main id="main">
    <header>
      <p id="header">
      <a href="../..">Home</a>

      &#124; <a href="../../blog/index.html">Blog</a>
      &#124; <a href="https://cmetcalfe.ca/feeds/all.rss">RSS Feed</a>
      </p>
<p>Tag: shell script
</p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="../../blog/limit-download-speed-by-ip-or-mac-address.html">Limit download speed by IP or MAC address</a></h1>
  </div>
  <div class="article_text">
    <h2>Preamble</h2>
<p>This article will focus on setting strict speed limits on misbehaving devices on your network. This can be a housemate incessantly torrenting, your kid downloading movies on iTunes, or anyone else clogging up your network with their overzealous bandwidth gobbling.</p>
<p>If you're looking for help with the QOS (quality of service) settings that come baked into most router firmwares, this article is not for you.</p>
<p>This article assumes you have a router running OpenWRT, DD-WRT, Tomato, or any other firmware that uses <a href="http://linux.die.net/man/8/tc"><code>tc</code></a> to manipulate traffic control settings.</p>
<h2>Procedure</h2>
<p>First, you'll need to get shell access to the router. With most custom router firmwares, this is as easy as selecting a radio button. Other firmwares might give you the ability to enter commands via a web interface. Whatever works.</p>
<p>Once you have shell access, follow the steps below. Note that bits of the commands you might want to change are included in brackets.</p>
<ol>
<li>
<p>Using <code>ifconfig</code>, find the interface to apply the limits to. You'll want to use either the internal or external default gateway (the interfaces all the packets go though). Keep in mind which interface you use as the filtering rules will be reversed. </p>
<ul>
<li>Internal gateway: to src = uploading, to dst = downloading</li>
<li>External gateway: to src = downloading, to dst = uploading</li>
</ul>
</li>
<li>
<p>Remove all existing rules on the interface (interface = <code>br0</code>)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc qdisc del dev br0 root
</pre></div>
</td></tr></table>

</li>
<li>
<p>Set up the connection (Ex: connection speed = 20mbit)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc qdisc add dev br0 root handle 1: cbq avpkt 1000 bandwidth 20mbit
</pre></div>
</td></tr></table>

</li>
<li>
<p>Add the limiting rule (Ex: speed limit = 10mbit)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc class add dev br0 parent 1: classid 1:1 cbq rate 10mbit allot 1500 prio 5 bounded isolated
</pre></div>
</td></tr></table>

</li>
<li>
<p>Filtering - Add the users to apply to rule to</p>
<ul>
<li>
<p>By src IP (Ex: IP = <code>192.168.1.100</code>)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc filter add dev br0 parent 1: protocol ip prio 16 u32 match ip src 192.168.1.100 flowid 1:1
</pre></div>
</td></tr></table>

</li>
<li>
<p>By dst IP (Ex: IP = <code>192.168.1.100</code>)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc filter add dev br0 parent 1: protocol ip prio 16 u32 match ip dst 192.168.1.100 flowid 1:1
</pre></div>
</td></tr></table>

</li>
<li>
<p>By src MAC (Ex: MAC = <code>M0-M1-M2-M3-M4-M5</code>)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc filter add dev br0 parent 1: protocol ip prio 5 u32 match u16 0x0800 0xFFFF at -2 match u16 0xM4M5 0xFFFF at -4 match u32 0xM0M1M2M3 0xFFFFFFFF at -8 flowid 1:1
</pre></div>
</td></tr></table>

</li>
<li>
<p>By dst MAC (Ex: MAC = <code>M0-M1-M2-M3-M4-M5</code>)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>tc filter add dev br0 parent 1: protocol ip prio 5 u32 match u16 0x0800 0xFFFF at -2 match u32 0xM2M3M4M5 0xFFFFFFFF at -12 match u16 0xM0M1 0xFFFF at -14 flowid 1:1
</pre></div>
</td></tr></table>

</li>
</ul>
</li>
</ol>
<h2>Sources</h2>
<ul>
<li>http://lartc.org/lartc.html</li>
<li>http://www.docum.org/faq/cache/62.html</li>
</ul>
  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="../../blog/github-convert-issue-to-pull-request.html">GitHub: Convert an issue to a pull request</a></h1>
  </div>
  <div class="article_text">
    <p><a href="http://github.com">GitHub</a> currently doesn't provide a way to convert an issue to a pull request in their interface.
However, the capability exists in their <a href="http://developer.github.com/v3/pulls/#alternative-input">Pull Request API</a>.</p>
<div class="admonition update">
<p class="admonition-title">Update</p>
<p>I've built a self-hostable webapp called <a href="https://github.com/pR0Ps/gh-i2p">gh-i2p</a> that makes this process easier.</p>
</div>
<p>To call the API using a simple <code>curl</code> command, run the command:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>curl --user <span class="s2">&quot;[github username]&quot;</span> <span class="se">\</span>
     --request POST <span class="se">\</span>
     --data <span class="s1">&#39;{&quot;issue&quot;: &quot;[issue num]&quot;, &quot;head&quot;: &quot;[branch to merge from]&quot;, &quot;base&quot;: &quot;[branch to merge into]&quot;}&#39;</span> <span class="se">\</span>
     https://api.github.com/repos/<span class="o">[</span>user<span class="o">]</span>/<span class="o">[</span>repo<span class="o">]</span>/pulls
</pre></div>
</td></tr></table>

<p>For example, to make <code>user1</code> change issue 13 into a pull request to merge branch <code>test_branch</code> into
<code>master</code> in the <code>testing_repo</code> repository belonging to <code>user2</code>, the command would be:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>curl --user <span class="s1">&#39;user1&#39;</span> <span class="se">\</span>
     --request POST <span class="se">\</span>
     --data <span class="s1">&#39;{&quot;issue&quot;: &quot;13&quot;, &quot;head&quot;: &quot;test_branch&quot;, &quot;base&quot;: &quot;master&quot;}&#39;</span> <span class="se">\</span>
     https://api.github.com/repos/user2/testing_repo/pulls
</pre></div>
</td></tr></table>

<p>To specify a fork of a repository to merge from, put the username followed by a semicolon in front
of the branch name like so: <code>"username:branch_name"</code></p>
<p>After running the command, you will be prompted for your GitHub password. Enter it and curl should
output the JSON response from the API. Make sure to check this response for errors!</p>
  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="../../blog/how-to-download-an-entire-google-site.html">How to download an entire Google Site</a></h1>
  </div>
  <div class="article_text">
    <p>When using Google Sites, there is currently no way to make a backup of your
site, or download the site so you can host it on another server.  </p>
<p>This command uses a tool called <code>wget</code> to spider through a website
and download all the public files to the local computer. Unix users will
most likely have the wget tool already installed (if not, you can
install it via your preferred package manager), while Windows users can
get it from <a href="http://gnuwin32.sourceforge.net/packages/wget.htm">here</a>.  </p>
<p>Once wget is installed, run it with the following parameters:  </p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#Downloads all public pages on a Google Site</span>

wget -e <span class="nv">robots</span><span class="o">=</span>off -m -k -K -E -rH -Dsites.google.com http://sites.google.com/a/domain/site/
</pre></div>
</td></tr></table>

<p>This tells wget to spider through all the links on your site and download
the html files and linked content (such as images). Note that pages that
aren't linked from anywhere on the site won't be downloaded.</p>
<p>This technique will also work for websites other than the ones hosted on Google Sites.</p>
  </div>
</article>

<footer>
<div id="paginator">
  <span id="left">
      <a href="../../blog/tags/shell-script2.html"><i class="fa fa-arrow-circle-left"></i> Prev</a>
  </span>
  <span id="right">
      <a href="../../blog/tags/shell-script4.html">Next <i class="fa fa-arrow-circle-right"></i></a>
  </span>
  <div>
      <a href="../../blog/tags/shell-script.html"> 1 </a>
      <a href="../../blog/tags/shell-script2.html"> 2 </a>
      <a href="../../blog/tags/shell-script3.html">[3]</a>
      <a href="../../blog/tags/shell-script4.html"> 4 </a>
  </div>
</div>
</footer>

    <div id="ending_message">
        <p>&copy; Carey Metcalfe. Built using <a href="http://getpelican.com">Pelican</a>. Theme is <a href="https://github.com/pR0Ps/pelican-subtle">subtle</a> by <a href="http://cmetcalfe.ca">Carey Metcalfe</a>. Based on <a href="https://github.com/giulivo/pelican-svbhack">svbhack</a> by Giulio Fidente.</p>
    </div>
  </main>

  <script type="text/javascript">
    window.addEventListener('load', skipHeader)
  </script>

  <script type="text/javascript">
  window.addEventListener('load', unmangleEmail)
  </script>
</body>
</html>